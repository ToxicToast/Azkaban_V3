name: Release

on:
  push:
    branches: [release]

env:
  NX_BRANCH: ${GITHUB_REF##*/}

jobs:
  Release:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Major version for each merge
        id: taggerDryRun
        uses: anothrNick/github-tag-action@1.69.0
        env:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
          WITH_V: true
          DRY_RUN: true
          DEFAULT_BUMP: major
          PRE_RELEASE: false

      - name: echo new tag
        run: |
          echo "${{ steps.taggerDryRun.outputs.new_tag }}"

      - name: ü™ê API Alerts Notify
        uses: ./.github/workflows/magpie/action.yml
        with:
          message: 'üö¢ Feature - New Version Released (${{ steps.taggerDryRun.outputs.new_tag }})'
          tags: 'Azkaban,Release'
          api_key: ${{ secrets.API_ALERTS_KEY }}
